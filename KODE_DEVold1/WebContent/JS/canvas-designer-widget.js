function CanvasDesigner(){function e(e){a.iframe&&a.postMessage({canvasDesignerSyncData:e})}function n(e){e.data&&e.data.uid===a.uid&&(e.data.canvasDesignerSyncData&&(a.pointsLength=e.data.canvasDesignerSyncData.points.length,s(e.data.canvasDesignerSyncData)),e.data.dataURL&&o(e.data.dataURL))}function t(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var e=window.crypto.getRandomValues(new Uint32Array(3)),n="",t=0,a=e.length;a>t;t++)n+=e[t].toString(36);return n}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}var a=this;a.iframe=null;var i={line:!0,arrow:!0,pencil:!0,dragSingle:!0,dragMultiple:!0,eraser:!0,rectangle:!0,arc:!0,bezier:!0,quadratic:!0,text:!0,image:!0,marker:!0},r="pencil",s=function(e){},o=function(e){};a.uid=t(),a.appendTo=function(e){a.iframe=document.createElement("iframe"),a.iframe.src=a.widgetHtmlURL+"?widgetJsURL="+a.widgetJsURL+"&tools="+JSON.stringify(i)+"&selectedIcon="+r,a.iframe.style.width="100%",a.iframe.style.height="430px",a.iframe.style.border=0,window.removeEventListener("message",n),window.addEventListener("message",n,!1),e.appendChild(a.iframe)},a.destroy=function(){a.iframe&&(a.iframe.parentNode.removeChild(a.iframe),a.iframe=null),window.removeEventListener("message",n)},a.addSyncListener=function(e){s=e},a.syncData=e,a.setTools=function(e){i=e},a.setSelected=function(e){"undefined"!=typeof i[e]&&(r=e)},a.toDataURL=function(e,n){o=n,a.iframe&&a.postMessage({genDataURL:!0,format:e})},a.sync=function(){a.iframe&&a.postMessage({syncPoints:!0})},a.pointsLength=0,a.undo=function(e){a.iframe&&a.postMessage({undo:!0,index:e||a.pointsLength-1||-1})},a.postMessage=function(e){a.iframe&&(e.uid=a.uid,a.iframe.contentWindow.postMessage(e,"*"))},a.widgetHtmlURL="widget.html",a.widgetJsURL="widget.min.js"}